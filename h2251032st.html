<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>에스 독해법 연습</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .diff-correct { background-color: #dcfce7; border-radius: 0.25rem; padding: 0 0.2rem; border-bottom: 2px solid #22c55e; }
        .diff-incorrect { background-color: #fee2e2; border-radius: 0.25rem; padding: 0 0.2rem; text-decoration: line-through; text-decoration-color: #ef4444; }
        @media print {
            body * { visibility: hidden; }
            #result-container, #result-container * { visibility: visible; }
            #result-container { position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none; }
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">
<div class="bg-white w-full max-w-4xl rounded-xl shadow-lg p-6 md:p-8 transition-all duration-500">
    <div id="problem-container"></div>
    <div id="result-container" class="hidden mt-8">
         <div class="border-b pb-3 mb-6"><h2 class="text-2xl font-bold text-gray-800">채점 결과</h2><p class="text-gray-500">입력한 답안과 정답을 비교한 결과입니다.</p></div>
        <div id="result-items" class="space-y-6"></div>
        <div id="result-buttons" class="flex flex-col md:flex-row gap-3 mt-8 no-print">
            <button onclick="saveAsPdf()" class="w-full md:w-1/2 bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>PDF로 저장하기</button>
             <button onclick="resetQuiz()" class="w-full md:w-1/2 bg-gray-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>다시 풀기</button>
        </div>
    </div>
</div>
<script>
    const { jsPDF } = window.jspdf;
    const quizData = {
  "pageId": "h2251032st-full",
  "instruction": "다음 문장을 에스독해법으로 해석하시오.",
  "sentences": [
    {
      "sentence": "Just as an expert in the taste and colour of wine will gain much by being aware of the chemistry that underlies those qualities, so each perspective on the body can potentially enhance the others.",
      "correctAnswer": "전문가가 [와인의 맛과 색에 대한] 많이 얻는 것과 마찬가지로 / 앎으로써 / 화학을 [그 품질들의 기초가 되는], / 그렇게 / 신체에 대한 각 관점은 / 잠재적으로 향상시킬 수 있다 / 다른 것들을."
    },
    {
      "sentence": "And yet every scientific tool, from microscopes to mathematics, and every aspect of the body, from the brain to the microorganism, requires such depth of expertise that this tends not to happen: we tend to study the human body in silos, each community sectioned from the others by its own specialised vocabulary.",
      "correctAnswer": "하지만 모든 과학적 도구는, / 현미경에서 수학에 이르기까지, / 그리고 신체의 모든 측면은, / 뇌에서 미생물에 이르기까지, / 그러한 깊이를 요구한다 / [전문 지식의] / 그래서 이것이 / 일어나지 않는 경향이 있다: / 우리는 / 연구하는 경향이 있다 / 인체를 / 개별적으로 분리해서, / 각 공동체는 다른 공동체들과 분리된 채로 / 그 자체의 전문화된 어휘에 의해."
    },
    {
      "sentence": "Research communities may be dedicated to one type of scientific tool or a specific component of the body, such as one type of cell.",
      "correctAnswer": "연구 공동체들은 / 전념할지도 모른다 / 한 종류의 과학적 도구나 / 또는 신체의 특정 구성 요소에, / 한 종류의 세포와 같은."
    },
    {
      "sentence": "How different types of cell communicate with one another becomes its own specialist topic.",
      "correctAnswer": "어떻게 다른 종류의 세포가 서로 소통하는지는 / 그 자체의 전문 주제가 된다."
    },
    {
      "sentence": "Even simple forms of life on Earth are now rarely studied as a whole, and the human body is evidently much more complex.",
      "correctAnswer": "심지어 지구상의 단순한 생명체 형태조차도 / 이제 거의 연구되지 않는다 / 전체로서, / 그리고 인체는 / 분명히 훨씬 더 복잡하다."
    },
    {
      "sentence": "As long ago as 1890, The Times newspaper commented that knowledge ‘had already become too vast to be manageable’.",
      "correctAnswer": "1890년만큼이나 오래 전에, / 타임스 신문은 / 논평했다 / 지식이 \\'이미 너무 방대해져서 / 감당할 수 없게 되었다\\'고."
    },
    {
      "sentence": "Today, nobody is an expert in the whole of anything.",
      "correctAnswer": "오늘날, / 아무도 전문가가 아니다 / 어떤 것의 전체에 있어서."
    }
  ]
};
    const problemContainer = document.getElementById('problem-container');
    const resultContainer = document.getElementById('result-container');
    let currentSentenceIndex = 0;
    let studentAnswers = [];

    function renderProblem() {
        const currentProblem = quizData.sentences[currentSentenceIndex];
        const isLastProblem = currentSentenceIndex === quizData.sentences.length - 1;
        const buttonText = isLastProblem ? "제출하고 채점하기" : "다음 문장";
        problemContainer.innerHTML = `
            <div class="flex justify-between items-center mb-4"><h1 class="text-2xl font-bold text-gray-800">${quizData.instruction}</h1><span class="text-sm font-medium text-gray-500 bg-gray-100 px-3 py-1 rounded-full">${currentSentenceIndex + 1} / ${quizData.sentences.length}</span></div>
            <p class="bg-gray-100 p-4 rounded-lg text-gray-700 my-4 leading-relaxed">${currentProblem.sentence}</p>
            <textarea id="student-input" class="w-full h-32 p-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="이곳에 에스독해법 해석을 입력하세요..."></textarea>
            <button onclick="submitAnswer()" class="w-full mt-4 bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">${buttonText}</button>
        `;
        document.getElementById('student-input').focus();
    }
    
    function submitAnswer() {
        const studentAnswer = document.getElementById('student-input').value;
        studentAnswers.push(studentAnswer);
        currentSentenceIndex++;
        if (currentSentenceIndex < quizData.sentences.length) { renderProblem(); } else { showFinalResults(); }
    }

    function showFinalResults() {
        problemContainer.classList.add('hidden');
        resultContainer.classList.remove('hidden');
        const resultItemsContainer = document.getElementById('result-items');
        resultItemsContainer.innerHTML = '';
        quizData.sentences.forEach((problem, index) => {
            const { studentHtml, correctHtml } = createDiffHtml(studentAnswers[index], problem.correctAnswer);
            resultItemsContainer.innerHTML += `
                <div class="border p-4 rounded-lg">
                    <p class="text-sm font-semibold text-gray-500 mb-2">문장 ${index + 1}</p>
                    <p class="mb-3 text-gray-800">${problem.sentence}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-gray-50 p-3 rounded-md"><h4 class="font-semibold text-gray-700 mb-2">나의 답안</h4><p class="whitespace-pre-wrap leading-relaxed">${studentHtml || '(입력 안 함)'}</p></div>
                        <div class="bg-gray-50 p-3 rounded-md"><h4 class="font-semibold text-gray-700 mb-2">정답</h4><p class="whitespace-pre-wrap leading-relaxed">${correctHtml}</p></div>
                    </div>
                </div>`;
        });
    }

    function resetQuiz() {
        currentSentenceIndex = 0;
        studentAnswers = [];
        resultContainer.classList.add('hidden');
        problemContainer.classList.remove('hidden');
        renderProblem();
    }
    
    function saveAsPdf() {
        const resultElement = document.getElementById('result-container');
        const originalTitle = document.title;
        document.title = 'h2251032st_results';
        document.getElementById('result-buttons').classList.add('no-print');
        html2canvas(resultElement).then(canvas => {
            const imgData = canvas.toDataURL('image/png');
            const pdf = new jsPDF('p', 'mm', 'a4');
            const imgProps = pdf.getImageProperties(imgData);
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save(`${document.title}.pdf`);
            document.getElementById('result-buttons').classList.remove('no-print');
            document.title = originalTitle;
        });
    }

    function createDiffHtml(studentText, correctText) {
        const studentWords = studentText.split(/(\s+|[/])/);
        const correctWords = correctText.split(/(\s+|[/])/);
        let studentHtml = '', correctHtml = '';
        const maxLength = Math.max(studentWords.length, correctWords.length);
        for (let i = 0; i < maxLength; i++) {
            const studentWord = studentWords[i] || '';
            const correctWord = correctWords[i] || '';
            if (studentWord === correctWord) {
                studentHtml += `<span>${escapeHtml(studentWord)}</span>`;
                correctHtml += `<span>${escapeHtml(correctWord)}</span>`;
            } else {
                if (studentWord) studentHtml += `<span class="diff-incorrect">${escapeHtml(studentWord)}</span>`;
                if (correctWord) correctHtml += `<span class="diff-correct">${escapeHtml(correctWord)}</span>`;
            }
        }
        return { studentHtml, correctHtml };
    }

    function escapeHtml(text) {
        return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
    }

    document.addEventListener('DOMContentLoaded', renderProblem);
</script>
</body>
</html>